<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©monstration de fonctions de hachage</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        .output-group {
            margin-top: 30px;
        }
        .hash-output {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #333;
            border: 2px solid #e9ecef;
            min-height: 60px;
        }
        .bit-length {
            margin-top: 10px;
            padding: 10px;
            background: #667eea;
            color: white;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        .empty-state {
            color: #999;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê D√©monstration de fonctions de hachage</h1>

        <div class="input-group">
            <label for="inputText">Texte √† hacher :</label>
            <input type="text" id="inputText" placeholder="Entrez le texte √† hacher...">
        </div>

        <div class="input-group">
            <label for="hashFunction">Fonction de hachage :</label>
            <select id="hashFunction">
                <option value="MD5">MD5</option>
                <option value="SHA-1" selected>SHA-1</option>
                <option value="SHA-256">SHA-256</option>
                <option value="SHA-384">SHA-384</option>
                <option value="SHA-512">SHA-512</option>
            </select>
        </div>

        <div class="output-group">
            <label id="outputLabel">R√©sultat du hachage (hexad√©cimal, 160 bits) :</label>
            <div class="hash-output" id="hashOutput">
                <span class="empty-state">Entrez du texte pour voir le hachage...</span>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script>
        const inputText = document.getElementById('inputText');
        const hashFunction = document.getElementById('hashFunction');
        const hashOutput = document.getElementById('hashOutput');
        const outputLabel = document.getElementById('outputLabel');

        const bitLengths = {
            'MD5': 128,
            'SHA-1': 160,
            'SHA-256': 256,
            'SHA-384': 384,
            'SHA-512': 512
        };

        async function computeHash() {
            let text = inputText.value;
            const algorithm = hashFunction.value;

            // Calculate hex length (bits / 4)
            const hexLength = bitLengths[algorithm] / 4;

            // Update label with bit length and hex length
            outputLabel.textContent = `R√©sultat du hachage (${bitLengths[algorithm]} bits, donc ${hexLength} chiffres hexad√©cimaux (base 16)) :`;

            if (!text) {
                hashOutput.innerHTML = '<span class="empty-state">Entrez du texte pour voir le hachage...</span>';
                return;
            }

            // Handle escape sequences like \0, \n, \r, \t, etc.
            text = text.replace(/\\0/g, '\0')
                      .replace(/\\n/g, '\n')
                      .replace(/\\r/g, '\r')
                      .replace(/\\t/g, '\t')
                      .replace(/\\\\/g, '\\');

            let hash = '';

            try {
                if (algorithm === 'MD5') {
                    hash = CryptoJS.MD5(text).toString();
                } else if (algorithm === 'SHA-1') {
                    hash = CryptoJS.SHA1(text).toString();
                } else if (algorithm === 'SHA-256') {
                    hash = CryptoJS.SHA256(text).toString();
                } else if (algorithm === 'SHA-384') {
                    hash = CryptoJS.SHA384(text).toString();
                } else if (algorithm === 'SHA-512') {
                    hash = CryptoJS.SHA512(text).toString();
                }

                hashOutput.textContent = hash;
            } catch (error) {
                hashOutput.innerHTML = '<span style="color: red;">Erreur lors du calcul du hachage</span>';
            }
        }

        inputText.addEventListener('input', computeHash);
        hashFunction.addEventListener('change', computeHash);

        // Initialize
        computeHash();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/iframe-resizer/js/iframeResizer.contentWindow.min.js"></script>
</body>
</html>